<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <marimo-mode data-mode='edit' hidden></marimo-mode>
    <marimo-version data-version='0.13.6' hidden></marimo-version>
    <marimo-user-config data-config='{"completion": {"activate_on_typing": true, "copilot": false}, "display": {"theme": "light", "code_editor_font_size": 14, "cell_output": "above", "default_width": "medium", "dataframes": "rich", "default_table_page_size": 10}, "formatting": {"line_length": 79}, "keymap": {"preset": "default", "overrides": {}}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "reactive_tests": true, "on_cell_change": "autorun", "watcher_on_save": "lazy", "output_max_bytes": 8000000, "std_stream_max_bytes": 1000000}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "package_management": {"manager": "pip"}, "server": {"browser": "default", "follow_symlink": false}, "language_servers": {"pylsp": {"enabled": true, "enable_mypy": true, "enable_ruff": true, "enable_flake8": false, "enable_pydocstyle": false, "enable_pylint": false, "enable_pyflakes": false}}, "snippets": {"custom_paths": [], "include_default_snippets": true}}' data-overrides='{}' hidden></marimo-user-config>
    <marimo-app-config data-config='{"width": "compact", "sql_output": "auto"}' hidden></marimo-app-config>
    <marimo-server-token data-token='123' hidden></marimo-server-token>
    <title>main</title>
    <script type="module" crossorigin src="./assets/index-D3XtisvU.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-33Q7xM_A.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="" data-show-code="false">import%20marimo%0A%0A__generated_with%20%3D%20%220.13.6%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%23%20%3Ccenter%3EMarimo's%20Tutorial%3C%2Fcenter%3E%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%23%231.%20Dataset%0A%0A%20%20%20%20To%20demonstrate%20the%20capabilities%20of%20Marimo%20and%20Altair%2C%20an%20exercise%20is%20proposed%20using%20a%20dataset%20containing%20information%20about%20users%20and%20bots%20from%20the%20Russian%20social%20network%20vk.com.%20This%20dataset%20can%20be%20found%20on%20%5BKaggle%5D(https%3A%2F%2Fwww.kaggle.com%2Fdatasets%2Fjuice0lover%2Fusers-vs-bots-classification).%0A%0A%20%20%20%20The%20dataset%20is%20used%20as%20an%20exercise%20to%20determine%20whether%20a%20user%20is%20a%20bot%20or%20a%20real%20person.%20Nowadays%2C%20this%20is%20a%20growing%20challenge%20for%20companies%2C%20as%20the%20creation%20of%20bot%20farms%20is%20becoming%20more%20common.%20These%20bots%20are%20used%20to%20generate%20spam%20or%2C%20even%20worse%2C%20to%20carry%20out%20denial-of-service%20attacks.%20In%20addition%20to%20this%20focus%2C%20the%20dataset%20can%20also%20be%20used%20for%20other%20related%20analyses.%0A%0A%20%20%20%20The%20dataset%20contains%20a%20total%20of%205%2C874%20entries%20and%2060%20columns%20or%20features.%20It%20is%20balanced%20with%20a%2050-50%20split%20between%20real%20user%20entries%20and%20bot%20entries.%20All%20accounts%20marked%20as%20real%20users%20were%20verified%2C%20as%20were%20all%20accounts%20marked%20as%20bots.%20The%20feature%20types%20vary%20and%20include%20numerical%20attributes%2C%20categorical%20attributes%2C%20binary%20attributes%2C%20and%20strings.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%232.%20Data%20loading%20and%20Transformation%0A%0A%20%20%20%20Data%20loading%20in%20marimo%20is%20great.%0A%0A%0A%20%20%20%20To%20load%20data%20you%20can%20use%20any%20method%20you%20already%20use.%20One%20great%20thing%20about%20marimo%20is%20that%20you%20have%20in%20your%20left%20tool%20bar%20access%20to%20all%20your%20data%20source%20for%20quick%20exploration.%20%0A%0A%0A%20%20%20%20For%20data%20transformation%20it%20is%20a%20bit%20the%20same%2C%20you%20can%20use%20everything%20you%20like%20from%20your%20prefered%20python%20libraries.%20%0A%0A%0A%20%20%20%20What%20is%20great%20is%20that%20we%20can%20take%20advantage%20of%20marimo%20reactivity%20to%20make%20our%20loading%20and%20exploration%20great.%20Let's%20take%20a%20look.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20pl)%3A%0A%20%20%20%20dataset_filepath%20%3D%20mo.notebook_location()%20%2F%20%22data%22%20%2F%20%22bots_vs_users.csv%22%0A%20%20%20%20bot_dataset%20%3D%20pl.read_csv(%0A%20%20%20%20%20%20%20%20str(dataset_filepath)%2C%0A%20%20%20%20%20%20%20%20null_values%3D%5B%22Unknown%22%5D%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(bot_dataset%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22First%20of%20course%20we%20can%20simply%20display%20static%20data%20by%20just%20calling%20the%20appropiate%20function%20like%20schema%20or%20describe.%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(bot_dataset%2C%20mo)%3A%0A%20%20%20%20schema%20%3D%20bot_dataset.schema%0A%0A%20%20%20%20schema_md%20%3D%20%22%5Cn%22.join(%5Bf%22-%20**%7Bname%7D**%3A%20%7Bdtype%7D%22%20for%20name%2C%20dtype%20in%20schema.items()%5D)%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%23%20DataFrame%20Schema%0A%20%20%20%20%7Bschema_md%7D%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(bot_dataset%2C%20mo)%3A%0A%20%20%20%20df_describe%20%3D%20bot_dataset.describe()%0A%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%23%20Descriptive%20Statistics%0A%20%20%20%20%7Bdf_describe.to_pandas().to_markdown()%7D%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20bot_dataset%2C%0A%20%20%20%20build_column_to_display_multiselect%2C%0A%20%20%20%20build_target_dropdown%2C%0A%20%20%20%20mo%2C%0A)%3A%0A%20%20%20%20title_target_selector%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%22%23%23%23%23%20But%20it%20is%20more%20fun%20if%20we%20make%20use%20of%20Marimo%20reactivity%20to%20explore%20the%20data%20with%20a%20filter!%22%0A%20%20%20%20)%0A%20%20%20%20target_selector%20%3D%20build_target_dropdown(bot_dataset)%0A%20%20%20%20selected_columns%20%3D%20build_column_to_display_multiselect(bot_dataset)%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20title_target_selector%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20selected_columns%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20target_selector%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20selected_columns%2C%20target_selector%0A%0A%0A%40app.cell%0Adef%20_(display_filtered_data%2C%20selected_columns%2C%20target_selector)%3A%0A%20%20%20%20display_filtered_data(target_selector%2C%20selected_columns)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Another%20cool%20thing%20about%20marimo%20is%20that%20it%20has%20SQL%20cells.%20From%20the%20deploy%20notebook%20you%20won't%20be%20able%20to%20see%20it%2C%20but%20if%20you%20run%20it%20on%20you%20own%2C%20you'll%20be%20able%20to%20play%20with%20the%20cell%20below.%20By%20default%20the%20SQL%20query%20is%20%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20SELECT%20target%2C%20has_last_name%20%0A%20%20%20%20FROM%20bot_dataset%20%0A%20%20%20%20WHERE%20has_last_name%20%3D%201%3B%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(bot_dataset%2C%20mo)%3A%0A%20%20%20%20sql_with_marimo%20%3D%20mo.sql(%0A%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20SELECT%20target%2C%20has_last_name%0A%20%20%20%20%20%20%20%20FROM%20bot_dataset%20%0A%20%20%20%20%20%20%20%20WHERE%20has_last_name%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%20(sql_with_marimo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22In%20the%20SQL%20cell%20you%20can%20name%20the%20output%20dataframe%20generated%20by%20your%20SQL%20query%2C%20we%20named%20it%20%60sql_with_marimo%60.%20You%20can%20use%20it%20as%20a%20normal%20dataframe%2C%20so%20you%20can%20do%20all%20the%20operations%20you%20want%20with%20it%2C%20for%20example%20in%20the%20cell%20below%20where%20we%20are%20just%20displaying%20it%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(sql_with_marimo)%3A%0A%20%20%20%20sql_with_marimo%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Cleaning%20the%20data%0A%0A%20%20%20%20The%20first%20thing%20we%20have%20to%20do%20is%20to%20clean%20the%20data.%20That%20means%20removing%20null%20values%20or%20replacing%20them%20with%20a%20value%20such%20as%20the%20median.%20In%20**Marimo**%20we%20can%20use%20the%20**Polars**%20or%20**Pandas**%20library%20to%20clean%20those%20values.%20Here%2C%20we%20are%20going%20to%20use%20**Polars**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(bot_dataset)%3A%0A%20%20%20%20bot_dataset.describe()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(bot_dataset%2C%20mo%2C%20pl)%3A%0A%20%20%20%20non_useful_columns%20%3D%20%5B%0A%20%20%20%20%20%20%20%20col%0A%20%20%20%20%20%20%20%20for%20col%20in%20bot_dataset.columns%0A%20%20%20%20%20%20%20%20if%20(bot_dataset.null_count().select(pl.col(col)).item()%20%2F%20len(bot_dataset))%0A%20%20%20%20%20%20%20%20%3E%200.25%0A%20%20%20%20%5D%0A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20rf%22%22%22%0A%20%20%20%20There%20is%20a%20lot%20of%20**null**%20values%20in%20the%20data.%20However%2C%20this%20is%20true%20to%20some%20columns%2C%20not%20all%20of%20them.%20As%20a%20result%2C%20we%20decided%20to%20eliminate%20the%20columns%20in%20which%20the%20amount%20of%20nulls%20is%20equal%20or%20greater%20than%20a%20quarter%20of%20the%20amount%20of%20rows.%20These%20are%3A%20%7B%22%5Cn%5Cn-%20%22%7D%7B%22%5Cn%5Cn-%20%22.join(non_useful_columns)%7D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%20(non_useful_columns%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22Now%20we%20can%20filter%20the%20dataset%20by%20these%20columns%20using%20the%20%60drop%60%20method%20of%20the%20dataframe.%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(bot_dataset%2C%20non_useful_columns)%3A%0A%20%20%20%20analysis_dataset%20%3D%20bot_dataset.drop(non_useful_columns)%0A%20%20%20%20analysis_dataset.describe()%0A%20%20%20%20return%20(analysis_dataset%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22Still%2C%20the%20dataset%20has%20some%20null%20values.%20We%20are%20going%20to%20replace%20them%20by%20the%20median%20of%20the%20non%20null%20values.%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(analysis_dataset%2C%20pl)%3A%0A%20%20%20%20clean_df%20%3D%20analysis_dataset.select(%0A%20%20%20%20%20%20%20%20%5Bpl.col(c).fill_null(pl.col(c).median())%20for%20c%20in%20analysis_dataset.columns%5D%0A%20%20%20%20)%0A%20%20%20%20%23%20Convert%0A%20%20%20%20pd_clean_df%20%3D%20clean_df.to_pandas()%0A%20%20%20%20return%20clean_df%2C%20pd_clean_df%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Univariable%20analysis%0A%0A%20%20%20%20To%20do%20univariable%20analysis%2C%20we%20are%20going%20to%20use%20**Altair**%20to%20demonstrate%20its%20capabilities%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Variables%20%0A%0A%20%20%20%20The%20first%20step%2C%20is%20to%20select%20the%20variables%20to%20analyze.%0A%0A%20%20%20%20For%20the%20univariable%20analysis%2C%20we%20are%20going%20to%20use%20the%20variables%3A%0A%0A%20%20%20%20-%20target%0A%20%20%20%20-%20gender%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22First%2C%20we%20are%20going%20to%20see%20the%20distribution%20of%20these%20values%3A%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20clean_df)%3A%0A%20%20%20%20target_bar_chart%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(clean_df)%0A%20%20%20%20%20%20%20%20.mark_bar()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%22target%3AN%22%2C%20%20%23%20N%20%3D%20Nominal%20(categorical)%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3D%22count()%3AQ%22%2C%20%20%23%20Q%20%3D%20Quantitative%20(count)%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22target%3AN%22%2C%20scale%3Dalt.Scale(range%3D%5B%22%234E8BC4%22%2C%20%22%2368c89d%22%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22target%3AN%22%2C%20%22count()%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(title%3D%22Bots%20v%20Humans%22)%0A%20%20%20%20)%0A%0A%20%20%20%20target_bar_chart%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22From%20here%20we%20can%20see%20that%20the%20list%20was%20created%20with%20an%20equal%20distribution%20of%20bots%20and%20users.%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20clean_df)%3A%0A%20%20%20%20gen_pie_data%20%3D%20clean_df%5B%22gender%22%5D.value_counts()%0A%20%20%20%20gen_pie_data.columns%20%3D%20%5B%22gender%22%2C%20%22count%22%5D%0A%0A%20%20%20%20%23%20Create%20the%20pie%20chart%0A%20%20%20%20gen_pie_chart%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(gen_pie_data)%0A%20%20%20%20%20%20%20%20.mark_arc()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20theta%3D%22count%3AQ%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22gender%3AN%22%2C%20scale%3Dalt.Scale(range%3D%5B%22red%22%2C%20%22%234E8BC4%22%2C%20%22%2368c89d%22%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22gender%22%2C%20%22count%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(title%3D%22Gender%20Distribution%22)%0A%20%20%20%20)%0A%0A%20%20%20%20(gen_pie_chart).configure_view(strokeWidth%3D0)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20According%20to%20the%20source%20documentation%2C%20the%20values%20for%20gender%20are%3A%0A%0A%20%20%20%20-%200%3A%20Not%20specified%0A%20%20%20%20-%201%3A%20Female%0A%20%20%20%20-%202%3A%20Male%0A%0A%20%20%20%20Based%20on%20this%2C%20we%20can%20notice%20that%20there%20are%20many%20more%20female%20users%20than%20male%20users%2C%20but%20it's%20worth%20noting%20that%20this%20is%20not%20removing%20the%20bot%20accounts%20from%20the%20total%2C%20and%20it%20the%20number%20of%20verified%20bots%20gainst%20the%20not%20specified%20are%20much%20more.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Multivariable%20analysis%0A%0A%20%20%20%20Now%20we%20are%20going%20to%20do%20some%20multivariable%20analysis%20with%20**Marimo**%20and%20**Altair**.%20Some%20common%20graphics%20are%20created%20with%20**Altair**%2C%20such%20as%20**heatmaps**%20and%20**bar%20plots**%20and%20interactivity%20is%20added%20with%20**Marimo**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Correlation%0A%0A%20%20%20%20We%20can%20observe%20the%20correlation%20between%20each%20pair%20of%20variables%2C%20taking%20into%20account%20that%20the%20variables%20are%20binary.%20Therefore%2C%20we%20need%20to%20use%20the%20Phi%20Coefficient%20(%5C(%5Cphi%5C)).%20The%20formula%20for%20the%20Phi%20coefficient%20(%5C(%5Cphi%5C))%20is%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cphi%20%3D%20%5Cfrac%7B(ad%20-%20bc)%7D%7B%5Csqrt%7B(a%2Bb)(a%2Bc)(b%2Bd)(c%2Bd)%7D%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20Where%3A%0A%0A%20%20%20%20-%20%5C(a%5C)%20is%20the%20number%20of%20cases%20where%20both%20variables%20are%201.%0A%20%20%20%20-%20%5C(b%5C)%20is%20the%20number%20of%20cases%20where%20the%20first%20variable%20is%201%20and%20the%20second%20is%200.%0A%20%20%20%20-%20%5C(c%5C)%20is%20the%20number%20of%20cases%20where%20the%20first%20variable%20is%200%20and%20the%20second%20is%201.%0A%20%20%20%20-%20%5C(d%5C)%20is%20the%20number%20of%20cases%20where%20both%20variables%20are%200.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(matthews_corrcoef%2C%20pd%2C%20pd_clean_df)%3A%0A%20%20%20%20%23%20Compute%20phi%0A%20%20%20%20data%20%3D%20%5B%5D%0A%20%20%20%20cols%20%3D%20pd_clean_df.columns%0A%20%20%20%20for%20i%20in%20cols%3A%0A%20%20%20%20%20%20%20%20for%20j%20in%20cols%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20phi%20%3D%20matthews_corrcoef(pd_clean_df%5Bi%5D%2C%20pd_clean_df%5Bj%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20data.append(%7B%22var1%22%3A%20i%2C%20%22var2%22%3A%20j%2C%20%22phi%22%3A%20phi%7D)%0A%0A%20%20%20%20phi_df%20%3D%20pd.DataFrame(data)%0A%20%20%20%20return%20(phi_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20mo%2C%20phi_df)%3A%0A%20%20%20%20heatmap%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(phi_df)%0A%20%20%20%20%20%20%20%20.mark_rect()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%22var1%3AO%22%2C%20title%3D%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22var2%3AO%22%2C%20title%3D%22%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22phi%3AQ%22%2C%20scale%3Dalt.Scale(scheme%3D%22redblue%22%2C%20domain%3D%5B-1%2C%201%5D))%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(title%3D%22Phi%20Correlation%20Heatmap%22)%0A%20%20%20%20)%0A%0A%20%20%20%20text%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(phi_df)%0A%20%20%20%20%20%20%20%20.mark_text(baseline%3D%22middle%22)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3D%22var1%3AO%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3D%22var2%3AO%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20text%3Dalt.Text(%22phi%3AQ%22%2C%20format%3D%22.2f%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.condition(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22abs(datum.phi)%20%3C%200.5%22%2C%20alt.value(%22black%22)%2C%20alt.value(%22white%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20mo.ui.altair_chart(%0A%20%20%20%20%20%20%20%20(heatmap%20%2B%20text).configure_axis(labelFontSize%3D10%2C%20titleFontSize%3D12)%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Seems%20that%20one%20of%20the%20most%20correlated%20variables%20to%20the%20target%20is%20the%20%60has_photo%60%20column%2C%20which%20makes%20sense%20since%20bots%20tend%20to%20not%20have%20profile%20photos.%0A%0A%20%20%20%20Also%2C%20an%20interesting%20thing%20to%20note%20is%20that%20some%20variables%20have%20a%200%20even%20though%20the%20correlation%20is%20with%20themselves.%20This%20happens%20because%20the%20have%20only%20one%20value%20(1%20or%200)%20in%20all%20the%20data%20samples%2C%20so%20the%20correlation%20with%20the%20Phi%20coefficient%20is%20undefined.%0A%0A%20%20%20%20These%20are%20valuable%20insights%20for%20a%20machine%20learning%20model%2C%20since%20those%20columns%20probably%20won't%20take%20any%20effect%20to%20predict%20the%20target.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Distribution%0A%0A%20%20%20%20We%20can%20see%20the%20distribution%20of%20data%20with%20respect%20to%20the%20%60target%60.%20We%20just%20need%20to%20choose%20one%20variable%20to%20see%20it.%20Fortunately%2C%20**Marimo**%20offers%20a%20**dropdown**%20box%20to%20choose%20from.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(clean_df%2C%20mo)%3A%0A%20%20%20%20%23%20UI%20Dropdown%20for%20feature%20selection%0A%20%20%20%20feature_select_1%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3Dclean_df.columns%2C%0A%20%20%20%20%20%20%20%20value%3D%22has_photo%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Select%20Feature%201%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20feature_select_2%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3Dclean_df.columns%2C%0A%20%20%20%20%20%20%20%20value%3D%22target%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Select%20Feature%202%22%2C%0A%20%20%20%20)%0A%20%20%20%20return%20feature_select_1%2C%20feature_select_2%0A%0A%0A%40app.cell%0Adef%20_(feature_select_1%2C%20feature_select_2)%3A%0A%20%20%20%20%23%20Reactive%20components%0A%20%20%20%20selected_feature_1%20%3D%20feature_select_1.value%0A%20%20%20%20selected_feature_2%20%3D%20feature_select_2.value%0A%20%20%20%20return%20selected_feature_1%2C%20selected_feature_2%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20clean_df%2C%20mo%2C%20selected_feature_1%2C%20selected_feature_2)%3A%0A%20%20%20%20chart_data%20%3D%20clean_df.to_pandas()%0A%0A%20%20%20%20mv_bar_plot_title_1%20%3D%20selected_feature_1.replace(%22_%22%2C%20%22%20%22).capitalize()%0A%20%20%20%20mv_bar_plot_title_2%20%3D%20selected_feature_2.replace(%22_%22%2C%20%22%20%22).capitalize()%0A%0A%20%20%20%20mv_bar_plot%20%3D%20mo.ui.altair_chart(%0A%20%20%20%20%20%20%20%20alt.Chart(chart_data)%0A%20%20%20%20%20%20%20%20.mark_bar()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(f%22%7Bselected_feature_2%7D%3AN%22%2C%20title%3Dmv_bar_plot_title_2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22count()%22%2C%20title%3D%22Count%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%7Bselected_feature_1%7D%3AN%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3Dmv_bar_plot_title_1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20legend%3Dalt.Legend(title%3Dmv_bar_plot_title_1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22count()%22%2C%20f%22%7Bselected_feature_1%7D%3AN%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(title%3Df%22Count%20of%20%7Bselected_feature_1%7D%20by%20%7Bselected_feature_2%7D%22)%0A%20%20%20%20)%0A%20%20%20%20return%20(mv_bar_plot%2C)%0A%0A%0A%40app.cell%0Adef%20_(feature_select_1%2C%20feature_select_2%2C%20mo%2C%20mv_bar_plot)%3A%0A%20%20%20%20%23%20Display%20all%20components%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20feature_select_1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20feature_select_2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mv_bar_plot%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(mv_bar_plot.value)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20It%20is%20clear%20that%20some%20variables%20such%20as%20%60has_photo%60%2C%20%60can_send_messages%60%20or%20even%20%60is_profile_closed%60%20have%20a%20different%20distribution%20across%20different%20targets.%20This%20indicates%20that%20these%20variables%20are%20very%20suitable%20to%20determine%20if%20a%20user%20is%20a%20bot.%20%0A%0A%20%20%20%20Even%20from%20this%20point%20of%20the%20analysis%2C%20possible%20recomendations%20for%20the%20social%20network%20platform%20would%20be%20measuring%20these%20three%20variables%20to%20close%20some%20accounts%20or%20give%20some%20warnings%20to%20the%20users.%0A%0A%20%20%20%20Finally%2C%20we%20also%20discovered%20some%20redundant%20variables%2C%20which%20are%20%60is_profile_closed%60%20and%20%60access_to_closed_profile%60%2C%20since%20they%20have%20a%20correlation%20of%20-1%20and%20they%20are%20perfectly%20separated%20if%20the%20two%20variables%20are%20in%20the%20bar%20plot.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20The%20order%20does%20not%20matter%0A%0A%20%20%20%20Marimo%20builds%20a%20DAG%20on%20your%20notebook%2C%20so%20it%20knows%20that%20depends%20on%20what%20eliminating%20hidden%20state%20problems.%20In%20doing%20so%2C%20we%20can%20put%20all%20our%20not%20important%20code%20in%20the%20end%20of%20the%20notebook%2C%20like%20an%20appendix.%20%F0%9F%A4%97%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20warnings%0A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20polars%20as%20pl%0A%0A%20%20%20%20return%20(pl%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%0A%20%20%20%20return%20(pd%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20numpy%20as%20np%0A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20scipy.stats%20as%20stats%0A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20sklearn.metrics%20import%20matthews_corrcoef%0A%0A%20%20%20%20return%20(matthews_corrcoef%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20altair%20as%20alt%0A%0A%20%20%20%20return%20(alt%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22For%20example%2C%20here%20I%20defined%20all%20the%20functions%20to%20build%20the%20ui%20for%20the%20data%20transformations%20and%20loading%20%F0%9F%9A%80%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20pl)%3A%0A%20%20%20%20def%20build_target_dropdown(bot_dataset%3A%20pl.dataframe)%20-%3E%20mo.ui.dropdown%3A%0A%20%20%20%20%20%20%20%20unique_targets%20%3D%20bot_dataset%5B%22target%22%5D.unique().sort().to_list()%0A%0A%20%20%20%20%20%20%20%20options_for_target%20%3D%20%7B%22Show%20All%22%3A%20%22ALL%22%7D%0A%20%20%20%20%20%20%20%20for%20val%20in%20unique_targets%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20options_for_target%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22Target%20Value%3A%20%7Bval%7D%20%7B'(bot)'%20if%20val%20%3D%3D%201%20else%20'(not%20a%20bot)'%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%20%3D%20str(val)%0A%0A%20%20%20%20%20%20%20%20return%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Doptions_for_target%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D%22Show%20All%22%2C%20%20%23%20Default%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22%F0%9F%8E%AF%20Filter%20by%20Target%20Value%3A%22%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20return%20(build_target_dropdown%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20pl)%3A%0A%20%20%20%20def%20build_column_to_display_multiselect(%0A%20%20%20%20%20%20%20%20bot_dataset%3A%20pl.dataframe%2C%0A%20%20%20%20)%20-%3E%20mo.ui.multiselect%3A%0A%20%20%20%20%20%20%20%20bot_dataset_options%20%3D%20%7Bcolumn%3A%20column%20for%20column%20in%20bot_dataset.columns%7D%0A%20%20%20%20%20%20%20%20return%20mo.ui.multiselect(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dbot_dataset_options%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Select%20the%20columns%20that%20you%20want%20to%20see!%22%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20return%20(build_column_to_display_multiselect%2C)%0A%0A%0A%40app.cell%0Adef%20_(bot_dataset%2C%20mo%2C%20pl)%3A%0A%20%20%20%20def%20display_filtered_data(%0A%20%20%20%20%20%20%20%20target_selector%3A%20mo.ui.dropdown%2C%0A%20%20%20%20%20%20%20%20selected_columns%3A%20mo.ui.multiselect%2C%0A%20%20%20%20)%20-%3E%20mo.vstack%3A%0A%20%20%20%20%20%20%20%20%23%20handle%20the%20target%20selector%20value%0A%20%20%20%20%20%20%20%20target_selector_value%20%3D%20target_selector.value%0A%0A%20%20%20%20%20%20%20%20if%20target_selector_value%20%3D%3D%20%22ALL%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20data_to_display%20%3D%20bot_dataset%0A%20%20%20%20%20%20%20%20%20%20%20%20status_md%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%23%23%23%20Displaying%20All%20Data%20(%7Bdata_to_display.height%7D%20rows)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20filter_target_as_int%20%3D%20int(target_selector_value)%0A%20%20%20%20%20%20%20%20%20%20%20%20data_to_display%20%3D%20bot_dataset.filter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%22target%22)%20%3D%3D%20filter_target_as_int%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20label%20%3D%20%22(bots)%22%20if%20filter_target_as_int%20%3D%3D%20%221%22%20else%20%22(Not%20bots)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20status_md%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%23%23%23%20Displaying%20Data%20for%20Target%20%3D%20**%7Bfilter_target_as_int%7D%20%7Blabel%7D**%20(%7Bdata_to_display.height%7D%20rows)%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20handle%20selected%20columns%0A%20%20%20%20%20%20%20%20columns_to_display%20%3D%20selected_columns.value%0A%20%20%20%20%20%20%20%20if%20not%20columns_to_display%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20columns_to_display%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22city%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22gender%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22avg_likes%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22posts_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22subscribers_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20if%20%22target%22%20not%20in%20columns_to_display%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20columns_to_display.insert(0%2C%20%22target%22)%0A%0A%20%20%20%20%20%20%20%20return%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20status_md%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20replace%20each%201%20in%20target%20column%20by%20the%20label%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data_to_display.select(columns_to_display)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20return%20(display_filtered_data%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
  </body>
</html>
